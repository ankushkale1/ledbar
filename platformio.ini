[env:nodemcuv2]
platform = espressif8266
board = d1_mini
framework = arduino
monitor_speed = 115200

; OTA Upload settings
upload_protocol = espota
upload_port = ledbar.local
upload_flags =
    --port=8266
    --auth=
    --progress

; Build flags for optimization
build_flags = 
    -O2                          ; Optimize for performance
    -DNDEBUG                     ; Disable assert() macros in release build
    -DPIO_FRAMEWORK_ARDUINO_LWIP2_LOW_MEMORY  ; Use lower memory LWIP stack
    -DVTABLES_IN_FLASH          ; Put vtables in flash to save RAM
    -ffunction-sections         ; Place each function in its own section
    -fdata-sections           ; Place each data item in its own section
    -Wall                    ; Enable all warnings

; Build-specific settings for release
board_build.f_cpu = 160000000L  ; Run at 160MHz for better performance
board_build.filesystem = littlefs
board_build.ldscript = eagle.flash.4m2m.ld  ; 4MB flash with 2MB filesystem

; Library dependencies
lib_deps =
    arduino-libraries/NTPClient@^3.2.1
    bblanchon/ArduinoJson@^6.0